//
// Generated by LLVM NVPTX Back-End
//

.version 8.3
.target sm_86
.address_size 64

	// .globl	layer_norm_fwd_kernel1
.extern .shared .align 16 .b8 global_smem[];
.global .align 1 .b8 _$_str[11] = {95, 95, 67, 85, 68, 65, 95, 70, 84, 90};
.global .align 1 .b8 _$_str_$_2[17] = {95, 95, 67, 85, 68, 65, 95, 80, 82, 69, 67, 95, 83, 81, 82, 84};

.visible .entry layer_norm_fwd_kernel1(
	.param .u64 layer_norm_fwd_kernel1_param_0,
	.param .u64 layer_norm_fwd_kernel1_param_1,
	.param .u64 layer_norm_fwd_kernel1_param_2,
	.param .u64 layer_norm_fwd_kernel1_param_3,
	.param .u64 layer_norm_fwd_kernel1_param_4,
	.param .u64 layer_norm_fwd_kernel1_param_5,
	.param .f32 layer_norm_fwd_kernel1_param_6
)
.maxntid 512, 1, 1
{
	.reg .pred 	%p<15>;
	.reg .b16 	%rs<21>;
	.reg .b32 	%r<65>;
	.reg .f32 	%f<53>;
	.reg .b64 	%rd<20>;
	.loc	1 264 0
$L__func_begin0:
	.loc	1 264 0

	ld.param.u64 	%rd7, [layer_norm_fwd_kernel1_param_0];
	ld.param.u64 	%rd8, [layer_norm_fwd_kernel1_param_1];
$L__tmp0:
	.loc	1 283 24
	// begin inline asm
	mov.u32 %r1, %ctaid.x;
	// end inline asm
	.loc	1 286 15
	shl.b32 	%r29, %r1, 11;
	ld.param.u64 	%rd9, [layer_norm_fwd_kernel1_param_2];
	ld.param.u64 	%rd10, [layer_norm_fwd_kernel1_param_3];
	.loc	1 286 9
	mul.wide.s32 	%rd11, %r29, 2;
	add.s64 	%rd12, %rd7, %rd11;
	ld.param.u64 	%rd13, [layer_norm_fwd_kernel1_param_4];
	.loc	1 289 15
	add.s64 	%rd14, %rd10, %rd11;
	ld.param.u64 	%rd15, [layer_norm_fwd_kernel1_param_5];
	.loc	1 291 19
	add.s64 	%rd16, %rd13, %rd11;
	ld.param.f32 	%f1, [layer_norm_fwd_kernel1_param_6];
	.loc	1 293 23
	mov.u32 	%r30, %tid.x;
	and.b32  	%r31, %r30, 31;
	shl.b32 	%r32, %r30, 2;
	and.b32  	%r33, %r32, 2044;
	.loc	1 295 22
	mul.wide.u32 	%rd17, %r33, 2;
	add.s64 	%rd1, %rd12, %rd17;
	mov.b32 	%r4, 0;
	mov.pred 	%p1, -1;
	.loc	1 295 18
	// begin inline asm
	mov.u32 %r2, 0x0;
	mov.u32 %r3, 0x0;
	@%p1 ld.global.v2.b32 { %r2, %r3 }, [ %rd1 + 0 ];
	@!%p1 mov.u32 %r2, %r4;
	@!%p1 mov.u32 %r3, %r4;
	// end inline asm
	.loc	1 297 29
	add.s64 	%rd2, %rd14, %rd17;
	.loc	1 297 23
	// begin inline asm
	mov.u32 %r6, 0x0;
	mov.u32 %r7, 0x0;
	@%p1 ld.global.v2.b32 { %r6, %r7 }, [ %rd2 + 0 ];
	@!%p1 mov.u32 %r6, %r4;
	@!%p1 mov.u32 %r7, %r4;
	// end inline asm
	.loc	1 295 51
	mov.b32 	{%rs1, %rs2}, %r2;
	cvt.f32.f16 	%f2, %rs2;
	cvt.f32.f16 	%f3, %rs1;
	.loc	1 297 58
	mov.b32 	{%rs3, %rs4}, %r6;
	cvt.f32.f16 	%f4, %rs4;
	cvt.f32.f16 	%f5, %rs3;
	.loc	1 297 15
	add.f32 	%f6, %f3, %f5;
	add.f32 	%f7, %f2, %f4;
	.loc	1 295 51
	mov.b32 	{%rs5, %rs6}, %r3;
	cvt.f32.f16 	%f8, %rs6;
	cvt.f32.f16 	%f9, %rs5;
	.loc	1 297 58
	mov.b32 	{%rs7, %rs8}, %r7;
	cvt.f32.f16 	%f10, %rs8;
	cvt.f32.f16 	%f11, %rs7;
	.loc	1 297 15
	add.f32 	%f12, %f9, %f11;
	add.f32 	%f13, %f8, %f10;
	.loc	1 299 27
	add.s64 	%rd3, %rd16, %rd17;
	.loc	1 299 32
	cvt.rn.f16.f32 	%rs9, %f7;
	cvt.rn.f16.f32 	%rs10, %f6;
	mov.b32 	%r38, {%rs10, %rs9};
	cvt.rn.f16.f32 	%rs11, %f13;
	cvt.rn.f16.f32 	%rs12, %f12;
	mov.b32 	%r39, {%rs12, %rs11};
	// begin inline asm
	@%p1 st.global.v2.b32 [ %rd3 + 0 ], { %r38, %r39 };
	// end inline asm
	.loc	1 307 32
	mul.f32 	%f14, %f7, %f7;
$L__tmp1:
	.loc	2 256 15
	fma.rn.f32 	%f15, %f6, %f6, %f14;
	fma.rn.f32 	%f16, %f12, %f12, %f15;
	fma.rn.f32 	%f17, %f13, %f13, %f16;
	.loc	2 267 36
	mov.b32 	%r40, %f17;
	shfl.sync.bfly.b32	%r41, %r40, 16, 31, -1;
	mov.b32 	%f18, %r41;
	.loc	2 256 15
	add.f32 	%f19, %f17, %f18;
	.loc	2 267 36
	mov.b32 	%r42, %f19;
	shfl.sync.bfly.b32	%r43, %r42, 8, 31, -1;
	mov.b32 	%f20, %r43;
	.loc	2 256 15
	add.f32 	%f21, %f19, %f20;
	.loc	2 267 36
	mov.b32 	%r44, %f21;
	shfl.sync.bfly.b32	%r45, %r44, 4, 31, -1;
	mov.b32 	%f22, %r45;
	.loc	2 256 15
	add.f32 	%f23, %f21, %f22;
	.loc	2 267 36
	mov.b32 	%r46, %f23;
	shfl.sync.bfly.b32	%r47, %r46, 2, 31, -1;
	mov.b32 	%f24, %r47;
	.loc	2 256 15
	add.f32 	%f25, %f23, %f24;
	.loc	2 267 36
	mov.b32 	%r48, %f25;
	shfl.sync.bfly.b32	%r49, %r48, 1, 31, -1;
	mov.b32 	%f26, %r49;
	.loc	2 256 15
	add.f32 	%f27, %f25, %f26;
	.loc	2 267 36
	setp.eq.s32 	%p8, %r31, 0;
	shr.u32 	%r50, %r30, 3;
	and.b32  	%r51, %r50, 60;
	mov.u32 	%r52, global_smem;
	add.s32 	%r12, %r52, %r51;
	mov.b32 	%r13, %f27;
	// begin inline asm
	@%p8 st.shared.b32 [ %r12 + 0 ], %r13;
	// end inline asm
	bar.sync 	0;
	setp.lt.s32 	%p9, %r30, 16;
	add.s32 	%r15, %r52, %r32;
	// begin inline asm
	@%p9 ld.shared.b32 %r14, [ %r15 + 0 ];
	// end inline asm
	mov.b32 	%f28, %r14;
	shfl.sync.bfly.b32	%r53, %r14, 8, 31, -1;
	mov.b32 	%f29, %r53;
	.loc	2 256 15
	add.f32 	%f30, %f28, %f29;
	.loc	2 267 36
	mov.b32 	%r54, %f30;
	shfl.sync.bfly.b32	%r55, %r54, 4, 31, -1;
	mov.b32 	%f31, %r55;
	.loc	2 256 15
	add.f32 	%f32, %f30, %f31;
	.loc	2 267 36
	mov.b32 	%r56, %f32;
	shfl.sync.bfly.b32	%r57, %r56, 2, 31, -1;
	mov.b32 	%f33, %r57;
	.loc	2 256 15
	add.f32 	%f34, %f32, %f33;
	.loc	2 267 36
	mov.b32 	%r58, %f34;
	shfl.sync.bfly.b32	%r59, %r58, 1, 31, -1;
	mov.b32 	%f35, %r59;
	.loc	2 256 15
	add.f32 	%f36, %f34, %f35;
	.loc	2 267 36
	and.b32  	%r60, %r30, 15;
	setp.eq.s32 	%p14, %r60, 0;
	and.pred  	%p10, %p9, %p14;
	mov.b32 	%r17, %f36;
	// begin inline asm
	@%p10 st.shared.b32 [ %r15 + 0 ], %r17;
	// end inline asm
	bar.sync 	0;
$L__tmp2:
	.loc	1 307 50
	ld.shared.u32 	%r19, [global_smem];
	mov.b32 	%r20, 1157627904;
	// begin inline asm
	div.full.f32 %r18, %r19, %r20;
	// end inline asm
	mov.b32 	%f37, %r18;
	.loc	1 308 33
	add.f32 	%f38, %f37, %f1;
	.loc	1 308 25
	sqrt.approx.ftz.f32 	%f39, %f38;
	.loc	1 287 9
	add.s64 	%rd18, %rd8, %rd11;
	.loc	1 308 17
	mov.b32 	%r23, %f39;
	mov.b32 	%r22, 1065353216;
	// begin inline asm
	div.full.f32 %r24, %r22, %r23;
	// end inline asm
	mov.b32 	%f40, %r24;
	.loc	1 309 20
	mul.wide.s32 	%rd19, %r1, 4;
	add.s64 	%rd4, %rd15, %rd19;
	.loc	1 309 25
	setp.eq.s32 	%p11, %r30, 0;
	// begin inline asm
	@%p11 st.global.b32 [ %rd4 + 0 ], { %r24 };
	// end inline asm
	.loc	1 312 36
	add.s64 	%rd5, %rd9, %rd17;
	.loc	1 312 22
	// begin inline asm
	mov.u32 %r25, 0x0;
	mov.u32 %r26, 0x0;
	@%p1 ld.global.v2.b32 { %r25, %r26 }, [ %rd5 + 0 ];
	// end inline asm
	.loc	1 321 17
	add.s64 	%rd6, %rd18, %rd17;
	.loc	1 312 54
	mov.b32 	{%rs13, %rs14}, %r25;
	cvt.f32.f16 	%f41, %rs14;
	cvt.f32.f16 	%f42, %rs13;
	.loc	1 315 68
	mul.f32 	%f43, %f7, %f40;
	mul.f32 	%f44, %f6, %f40;
	.loc	1 316 20
	mul.f32 	%f45, %f44, %f42;
	mul.f32 	%f46, %f43, %f41;
	.loc	1 321 22
	cvt.rn.f16.f32 	%rs15, %f46;
	cvt.rn.f16.f32 	%rs16, %f45;
	mov.b32 	%r63, {%rs16, %rs15};
	.loc	1 312 54
	mov.b32 	{%rs17, %rs18}, %r26;
	cvt.f32.f16 	%f47, %rs18;
	cvt.f32.f16 	%f48, %rs17;
	.loc	1 315 68
	mul.f32 	%f49, %f13, %f40;
	mul.f32 	%f50, %f12, %f40;
	.loc	1 316 20
	mul.f32 	%f51, %f50, %f48;
	mul.f32 	%f52, %f49, %f47;
	.loc	1 321 22
	cvt.rn.f16.f32 	%rs19, %f52;
	cvt.rn.f16.f32 	%rs20, %f51;
	mov.b32 	%r64, {%rs20, %rs19};
	// begin inline asm
	@%p1 st.global.v2.b32 [ %rd6 + 0 ], { %r63, %r64 };
	// end inline asm
	.loc	1 321 4
	ret;
$L__tmp3:
$L__func_end0:

}
	.file	1 "D:\\Users\\Louis\\PycharmProjects\\Master_thesis\\Babilong_Benchmark\\.venv\\Lib\\site-packages\\fla\\modules\\layernorm.py"
	.file	2 "D:\\Users\\Louis\\PycharmProjects\\Master_thesis\\Babilong_Benchmark\\.venv\\Lib\\site-packages\\triton\\language\\standard.py"
	.section	.debug_abbrev
	{
.b8 1
.b8 17
.b8 1
.b8 37
.b8 8
.b8 19
.b8 5
.b8 3
.b8 8
.b8 16
.b8 6
.b8 27
.b8 8
.b8 17
.b8 1
.b8 18
.b8 1
.b8 0
.b8 0
.b8 2
.b8 46
.b8 0
.b8 3
.b8 8
.b8 32
.b8 11
.b8 0
.b8 0
.b8 3
.b8 46
.b8 1
.b8 17
.b8 1
.b8 18
.b8 1
.b8 49
.b8 19
.b8 0
.b8 0
.b8 4
.b8 29
.b8 0
.b8 49
.b8 19
.b8 17
.b8 1
.b8 18
.b8 1
.b8 88
.b8 11
.b8 89
.b8 5
.b8 87
.b8 11
.b8 0
.b8 0
.b8 0
	}
	.section	.debug_info
	{
.b32 223
.b8 2
.b8 0
.b32 .debug_abbrev
.b8 8
.b8 1
.b8 116
.b8 114
.b8 105
.b8 116
.b8 111
.b8 110
.b8 0
.b8 2
.b8 0
.b8 108
.b8 97
.b8 121
.b8 101
.b8 114
.b8 110
.b8 111
.b8 114
.b8 109
.b8 46
.b8 112
.b8 121
.b8 0
.b32 .debug_line
.b8 68
.b8 58
.b8 92
.b8 85
.b8 115
.b8 101
.b8 114
.b8 115
.b8 92
.b8 76
.b8 111
.b8 117
.b8 105
.b8 115
.b8 92
.b8 80
.b8 121
.b8 99
.b8 104
.b8 97
.b8 114
.b8 109
.b8 80
.b8 114
.b8 111
.b8 106
.b8 101
.b8 99
.b8 116
.b8 115
.b8 92
.b8 77
.b8 97
.b8 115
.b8 116
.b8 101
.b8 114
.b8 95
.b8 116
.b8 104
.b8 101
.b8 115
.b8 105
.b8 115
.b8 92
.b8 66
.b8 97
.b8 98
.b8 105
.b8 108
.b8 111
.b8 110
.b8 103
.b8 95
.b8 66
.b8 101
.b8 110
.b8 99
.b8 104
.b8 109
.b8 97
.b8 114
.b8 107
.b8 92
.b8 46
.b8 118
.b8 101
.b8 110
.b8 118
.b8 92
.b8 76
.b8 105
.b8 98
.b8 92
.b8 115
.b8 105
.b8 116
.b8 101
.b8 45
.b8 112
.b8 97
.b8 99
.b8 107
.b8 97
.b8 103
.b8 101
.b8 115
.b8 92
.b8 102
.b8 108
.b8 97
.b8 92
.b8 109
.b8 111
.b8 100
.b8 117
.b8 108
.b8 101
.b8 115
.b8 0
.b64 $L__func_begin0
.b64 $L__func_end0
.b8 2
.b8 108
.b8 97
.b8 121
.b8 101
.b8 114
.b8 95
.b8 110
.b8 111
.b8 114
.b8 109
.b8 95
.b8 102
.b8 119
.b8 100
.b8 95
.b8 107
.b8 101
.b8 114
.b8 110
.b8 101
.b8 108
.b8 49
.b8 0
.b8 1
.b8 3
.b64 $L__func_begin0
.b64 $L__func_end0
.b32 154
.b8 4
.b32 154
.b64 $L__tmp1
.b64 $L__tmp2
.b8 1
.b8 51
.b8 1
.b8 23
.b8 0
.b8 0
	}
	.section	.debug_loc	{	}
